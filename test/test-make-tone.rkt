#lang racket

(require (planet clements/rsound)
         (planet clements/rsound/integral-cycles)
         rackunit)


(check-equal? (cycles-to-use 441 44100.0) 1)
(check-equal? (cycles-to-use 440 44100.0) 22)
(check-equal? (cycles-to-use (* 440 (expt 2 1/12)) 44100.0) 103)


(time
 (map
  (lambda (p) (apply make-tone p))
  '((130.8127826502993 91/1270 220040)
    (130.8127826502993 91/1270 220040)
    (130.8127826502993 10/127 220040)
    (130.8127826502993 10/127 220040)
    (130.8127826502993 10/127 220040)
    (130.8127826502993 10/127 220040)
    (130.8127826502993 10/127 220040)
    (130.8127826502993 10/127 220040)
    (130.8127826502993 10/127 220040)
    (130.8127826502993 10/127 220040)
    (130.8127826502993 10/127 220040)
    (130.8127826502993 10/127 220040)
    (130.8127826502993 10/127 220040)
    (130.8127826502993 10/127 220040)
    (130.8127826502993 10/127 220040)
    (130.8127826502993 10/127 220040)
    (130.8127826502993 10/127 220040)
    (130.8127826502993 10/127 220040)
    (146.8323839587038 89/1270 330290)
    (146.8323839587038 89/1270 330290)
    (146.8323839587038 10/127 330290)
    (146.8323839587038 10/127 330290)
    (146.8323839587038 10/127 330290)
    (146.8323839587038 10/127 330290)
    (146.8323839587038 10/127 330290)
    (146.8323839587038 10/127 330290)
    (146.8323839587038 10/127 330290)
    (146.8323839587038 10/127 330290)
    (146.8323839587038 10/127 330290)
    (146.8323839587038 10/127 330290)
    (146.8323839587038 10/127 330290)
    (146.8323839587038 10/127 330290)
    (146.8323839587038 10/127 330290)
    (146.8323839587038 10/127 330290)
    (146.8323839587038 10/127 330290)
    (146.8323839587038 10/127 330290)
    (164.81377845643496 10/127 330290)
    (164.81377845643496 51/635 220040)
    (164.81377845643496 10/127 330290)
    (164.81377845643496 51/635 220040)
    (164.81377845643496 10/127 330290)
    (164.81377845643496 10/127 220040)
    (164.81377845643496 10/127 330290)
    (164.81377845643496 10/127 220040)
    (164.81377845643496 10/127 330290)
    (164.81377845643496 10/127 220040)
    (164.81377845643496 10/127 330290)
    (164.81377845643496 10/127 220040)
    (164.81377845643496 10/127 330290)
    (164.81377845643496 10/127 220040)
    (164.81377845643496 10/127 330290)
    (164.81377845643496 10/127 220040)
    (164.81377845643496 10/127 330290)
    (164.81377845643496 10/127 220040)
    (164.81377845643496 10/127 330290)
    (164.81377845643496 10/127 220040)
    (164.81377845643496 10/127 330290)
    (164.81377845643496 10/127 220040)
    (164.81377845643496 10/127 330290)
    (164.81377845643496 10/127 220040)
    (164.81377845643496 10/127 330290)
    (164.81377845643496 10/127 220040)
    (164.81377845643496 10/127 330290)
    (164.81377845643496 10/127 330290)
    (164.81377845643496 10/127 220040)
    (164.81377845643496 10/127 330290)
    (164.81377845643496 10/127 220040)
    (164.81377845643496 10/127 330290)
    (164.81377845643496 10/127 220040)
    (164.81377845643496 10/127 330290)
    (164.81377845643496 10/127 220040)
    (174.61411571650194 44/635 110020)
    (174.61411571650194 44/635 110020)
    (174.61411571650194 10/127 110020)
    (174.61411571650194 10/127 110020)
    (174.61411571650194 10/127 110020)
    (174.61411571650194 10/127 110020)
    (174.61411571650194 10/127 110020)
    (174.61411571650194 10/127 110020)
    (174.61411571650194 10/127 110020)
    (174.61411571650194 10/127 110020)
    (174.61411571650194 10/127 110020)
    (174.61411571650194 10/127 110020)
    (174.61411571650194 10/127 110020)
    (174.61411571650194 10/127 110020)
    (174.61411571650194 10/127 110020)
    (174.61411571650194 10/127 110020)
    (174.61411571650194 10/127 110020)
    (174.61411571650194 10/127 110020)
    (195.99771799087463 48/635 111168)
    (195.99771799087463 48/635 111168)
    (195.99771799087463 10/127 109790)
    (195.99771799087463 10/127 111168)
    (195.99771799087463 10/127 111168)
    (195.99771799087463 10/127 109790)
    (195.99771799087463 10/127 111168)
    (195.99771799087463 10/127 111168)
    (195.99771799087463 10/127 109790)
    (195.99771799087463 10/127 111168)
    (195.99771799087463 10/127 111168)
    (195.99771799087463 10/127 109790)
    (195.99771799087463 10/127 111168)
    (195.99771799087463 10/127 111168)
    (195.99771799087463 10/127 109790)
    (195.99771799087463 10/127 111168)
    (195.99771799087463 10/127 111168)
    (195.99771799087463 10/127 109790)
    (195.99771799087463 10/127 111168)
    (195.99771799087463 10/127 109790)
    (195.99771799087463 10/127 111168)
    (195.99771799087463 10/127 111168)
    (195.99771799087463 10/127 109790)
    (195.99771799087463 10/127 111168)
    (195.99771799087463 10/127 111168)
    (207.65234878997256 99/1270 109790)
    (207.65234878997256 99/1270 109790)
    (207.65234878997256 10/127 109790)
    (207.65234878997256 10/127 109790)
    (207.65234878997256 10/127 109790)
    (207.65234878997256 10/127 109790)
    (207.65234878997256 10/127 109790)
    (207.65234878997256 10/127 109790)
    (207.65234878997256 10/127 109790)
    (207.65234878997256 10/127 109790)
    (220 91/1270 220040)
    (220 91/1270 220040)
    (220 10/127 220040)
    (220 10/127 220040)
    (220 10/127 220040)
    (220 10/127 220040)
    (220 10/127 220040)
    (220 10/127 220040)
    (220 10/127 220040)
    (220 10/127 220040)
    (220 10/127 220040)
    (220 10/127 220040)
    (220 10/127 220040)
    (220 10/127 220040)
    (220 10/127 220040)
    (220 10/127 220040)
    (220 10/127 220040)
    (220 10/127 220040)
    (261.6255653005986 91/1270 220040)
    (261.6255653005986 99/1270 109790)
    (261.6255653005986 91/1270 220040)
    (261.6255653005986 99/1270 109790)
    (261.6255653005986 10/127 220040)
    (261.6255653005986 10/127 109790)
    (261.6255653005986 10/127 220040)
    (261.6255653005986 10/127 109790)
    (261.6255653005986 10/127 220040)
    (261.6255653005986 10/127 109790)
    (261.6255653005986 10/127 220040)
    (261.6255653005986 10/127 109790)
    (261.6255653005986 10/127 220040)
    (261.6255653005986 10/127 109790)
    (261.6255653005986 10/127 220040)
    (261.6255653005986 10/127 109790)
    (261.6255653005986 10/127 220040)
    (261.6255653005986 10/127 109790)
    (261.6255653005986 10/127 220040)
    (261.6255653005986 10/127 109790)
    (261.6255653005986 10/127 220040)
    (261.6255653005986 10/127 109790)
    (261.6255653005986 10/127 220040)
    (261.6255653005986 10/127 109790)
    (261.6255653005986 10/127 220040)
    (261.6255653005986 10/127 109790)
    (261.6255653005986 10/127 220040)
    (261.6255653005986 10/127 220040)
    (261.6255653005986 10/127 109790)
    (261.6255653005986 10/127 220040)
    (261.6255653005986 10/127 109790)
    (261.6255653005986 10/127 220040)
    (261.6255653005986 10/127 109790)
    (261.6255653005986 10/127 220040)
    (261.6255653005986 10/127 109790)
    (293.6647679174076 89/1270 330290)
    (293.6647679174076 89/1270 330290)
    (293.6647679174076 10/127 330290)
    (293.6647679174076 10/127 330290)
    (293.6647679174076 10/127 330290)
    (293.6647679174076 10/127 330290)
    (293.6647679174076 10/127 330290)
    (293.6647679174076 10/127 330290)
    (293.6647679174076 10/127 330290)
    (293.6647679174076 10/127 330290)
    (293.6647679174076 10/127 330290)
    (293.6647679174076 10/127 330290)
    (293.6647679174076 10/127 330290)
    (293.6647679174076 10/127 330290)
    (293.6647679174076 10/127 330290)
    (293.6647679174076 10/127 330290)
    (293.6647679174076 10/127 330290)
    (293.6647679174076 10/127 330290)
    (329.6275569128699 10/127 330290)
    (329.6275569128699 51/635 220040)
    (329.6275569128699 10/127 330290)
    (329.6275569128699 51/635 220040)
    (329.6275569128699 10/127 330290)
    (329.6275569128699 10/127 220040)
    (329.6275569128699 10/127 330290)
    (329.6275569128699 10/127 220040)
    (329.6275569128699 10/127 330290)
    (329.6275569128699 10/127 220040)
    (329.6275569128699 10/127 330290)
    (329.6275569128699 10/127 220040)
    (329.6275569128699 10/127 330290)
    (329.6275569128699 10/127 220040)
    (329.6275569128699 10/127 330290)
    (329.6275569128699 10/127 220040)
    (329.6275569128699 10/127 330290)
    (329.6275569128699 10/127 220040)
    (329.6275569128699 10/127 330290)
    (329.6275569128699 10/127 220040)
    (329.6275569128699 10/127 330290)
    (329.6275569128699 10/127 220040)
    (329.6275569128699 10/127 330290)
    (329.6275569128699 10/127 220040)
    (329.6275569128699 10/127 330290)
    (329.6275569128699 10/127 220040)
    (329.6275569128699 10/127 330290)
    (329.6275569128699 10/127 330290)
    (329.6275569128699 10/127 220040)
    (329.6275569128699 10/127 330290)
    (329.6275569128699 10/127 220040)
    (329.6275569128699 10/127 330290)
    (329.6275569128699 10/127 220040)
    (329.6275569128699 10/127 330290)
    (329.6275569128699 10/127 220040)
    (349.2282314330039 44/635 110020)
    (349.2282314330039 44/635 110020)
    (349.2282314330039 10/127 110020)
    (349.2282314330039 10/127 110020)
    (349.2282314330039 10/127 110020)
    (349.2282314330039 10/127 110020)
    (349.2282314330039 10/127 110020)
    (349.2282314330039 10/127 110020)
    (349.2282314330039 10/127 110020)
    (349.2282314330039 10/127 110020)
    (349.2282314330039 10/127 110020)
    (349.2282314330039 10/127 110020)
    (349.2282314330039 10/127 110020)
    (349.2282314330039 10/127 110020)
    (349.2282314330039 10/127 110020)
    (349.2282314330039 10/127 110020)
    (349.2282314330039 10/127 110020)
    (349.2282314330039 10/127 110020)
    (391.99543598174927 48/635 111168)
    (391.99543598174927 48/635 111168)
    (391.99543598174927 10/127 109790)
    (391.99543598174927 10/127 111168)
    (391.99543598174927 10/127 111168)
    (391.99543598174927 10/127 109790)
    (391.99543598174927 10/127 111168)
    (391.99543598174927 10/127 111168)
    (391.99543598174927 10/127 109790)
    (391.99543598174927 10/127 111168)
    (391.99543598174927 10/127 111168)
    (391.99543598174927 10/127 109790)
    (391.99543598174927 10/127 111168)
    (391.99543598174927 10/127 111168)
    (391.99543598174927 10/127 109790)
    (391.99543598174927 10/127 111168)
    (391.99543598174927 10/127 111168)
    (391.99543598174927 10/127 109790)
    (391.99543598174927 10/127 111168)
    (391.99543598174927 10/127 109790)
    (391.99543598174927 10/127 111168)
    (391.99543598174927 10/127 111168)
    (391.99543598174927 10/127 109790)
    (391.99543598174927 10/127 111168)
    (391.99543598174927 10/127 111168)
    (415.3046975799451 99/1270 109790)
    (415.3046975799451 99/1270 109790)
    (415.3046975799451 10/127 109790)
    (415.3046975799451 10/127 109790)
    (415.3046975799451 10/127 109790)
    (415.3046975799451 10/127 109790)
    (415.3046975799451 10/127 109790)
    (415.3046975799451 10/127 109790)
    (415.3046975799451 10/127 109790)
    (415.3046975799451 10/127 109790)
    (440 91/1270 220040)
    (440 91/1270 220040)
    (440 10/127 220040)
    (440 10/127 220040)
    (440 10/127 220040)
    (440 10/127 220040)
    (440 10/127 220040)
    (440 10/127 220040)
    (440 10/127 220040)
    (440 10/127 220040)
    (440 10/127 220040)
    (440 10/127 220040)
    (440 10/127 220040)
    (440 10/127 220040)
    (440 10/127 220040)
    (440 10/127 220040)
    (440 10/127 220040)
    (440 10/127 220040)
    (523.2511306011972 99/1270 109790)
    (523.2511306011972 99/1270 109790)
    (523.2511306011972 10/127 109790)
    (523.2511306011972 10/127 109790)
    (523.2511306011972 10/127 109790)
    (523.2511306011972 10/127 109790)
    (523.2511306011972 10/127 109790)
    (523.2511306011972 10/127 109790)
    (523.2511306011972 10/127 109790)
    (523.2511306011972 10/127 109790)
    (523.2511306011972 10/127 109790)
    (523.2511306011972 10/127 109790)
    (523.2511306011972 10/127 109790)
    (523.2511306011972 10/127 109790)
    (523.2511306011972 10/127 109790)
    (523.2511306011972 10/127 109790)
    (523.2511306011972 10/127 109790)))
(define-values (dc t1 t2 t3)
  (time-apply
   (lambda ()
     (list
      (make-tone 130 91/1270 220040)
      (make-tone 130 10/127 220040)
      (make-tone 146 89/1270 330290)
      (make-tone 146 10/127 330290)
      (make-tone 164 10/127 330290)
      (make-tone 164 51/635 220040)
      (make-tone 174 44/635 110020)
      (make-tone 174 10/127 110020)
      (make-tone 195 48/635 111168)
      (make-tone 195 10/127 109790)
      (make-tone 195 10/127 111168)
      (make-tone 207 99/1270 109790)
      (make-tone 207 10/127 109790)
      (make-tone 220 91/1270 220040)
      (make-tone 220 10/127 220040)
      (make-tone 261 91/1270 220040)
      (make-tone 261 99/1270 109790)
      (make-tone 261 10/127 220040)
      (make-tone 293 89/1270 330290)
      (make-tone 293 10/127 330290)
      (make-tone 329 10/127 330290)
      (make-tone 329 51/635 220040)
      (make-tone 349 44/635 110020)
      (make-tone 349 10/127 110020)
      (make-tone 391 48/635 111168)
      (make-tone 391 10/127 109790)
      (make-tone 391 10/127 111168)
      (make-tone 415 99/1270 109790)
      (make-tone 415 10/127 109790)
      (make-tone 440 91/1270 220040)
      (make-tone 440 10/127 220040)
      (make-tone 523 99/1270 109790)
      (make-tone 523 10/127 109790)))
   (list)))

(check < t1 1000)
